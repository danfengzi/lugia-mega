# 元信息规范

## 页面元信息

```js
// import React from 'react';
// import { routerRedux } from '@lugia/router';
// import lugiax from '@lugia/lugiax';
// import List from '../model/list';

export default {
  "page": "Dashboard", // 页面名
  "route": "/dashboard", // path
  "layout": "@lugia/header-aside-footer-layout",
  "blocks": [
    {
      "name": "text-search-list-block",
      "dirName": "TextSearchListBlock",
      "version": "latest",
      "title": "展示型卡片",
      "props": {
        title: state.title,
        dataSource: state.dataSource,
      },
      "events": {
        onChange: {
          model: 'modelName',
          // model下的state的路径
          path:  'user.name',
          //不同组件的onChange事件可能结构不同，所以要告知BindValue如何获取对应的值，
          // getValue 默认为  v=>v
          getValue : (e)=> ({value: e.value}),
        },
      }
    },
    {
      "name": "tab-block",
      "dirName": "TabBlock",
      "customBlock": true,
      "title": "标签页",
    },
  ]
},
```

## 根目录下的项目元信息

供 `desktop` 使用

`.lugia/generator.js`

- 存储已使用的区块、布局元信息
- 存储页面元信息

```js
// import React from 'react';
// import {
//   Router,
//   // browserHistory,
//   hashHistory,
//   routerRedux,
// } from '@lugia/router';
// import { connect } from '@lugia/lugiax';

export default {
  layouts: {
    '@lugia/header-footer-layout': {},
    '@lugia/header-aside-footer-layout': {},
  },
  blocks: {
    'text-search-list-block': {
      // (必)标识名 英文
      name: 'text-search-list-block',

      // (必)标题
      title: '文本搜索列表',

      // （必）文件名
      dirName: 'TextSearchListBlock',

      // (可)区块详细说明
      description: '',

      // (必) download 字段描述区块下载方式
      download: {
        type: 'npm', // 或者 github、gitlab、local
        // npm
        packageName: 'text-search-list-block',
        registry: 'http://192.168.102.79:5001/', // (可)
        version: '1.0.0',
        // npm end

        // github
        repository: 'owner/name',
        clone: false,
        branch: 'master',
        // github end

        // gitlab
        repository: 'owner/name',
        clone: false,
        branch: 'master',
        customOrigin: 'http://192.168.102.73:8081/',
        // gitlab end

        // local
        path: '/f/UI-Kits/TextSearchListBlock',
        // local end

        sourceCodeDirectory: 'src',
      },

      // (必) 分类
      categories: ['信息展示'],

      // (必) 截图
      screenshot: 'https://xxx.png',

      // (必) 发布时间
      publishTime: '1535979136796',

      // (必) 最后修改时间
      updateTime: '1535979136796',

      // (可) 额外依赖项
      dependencies: {
        uri: '1.0.1',
      },

      // (必) 外部使用的依据
      useConfig: {
        propTypes: {},
        defaultProps: {},
        props: {},
        events: {},
      },

      // (可) 保留字段, 依赖组件
      components: {
        '@lugia/web/table': {},
      },

      // (可) 保留字段
      extra: {
        // 分词, 用于搜索
        participle: {
          /* ... */
        },
      },
    },
  },
  pages: [
    {
      page: 'Dashboard',
      route: '/',
      layout: '@lugia/header-aside-footer-layout',
      blocks: [
        {
          name: 'text-search-list-block',
          dirName: 'TextSearchListBlock',
          version: 'latest',
          title: '展示型卡片',
        },
        {
          name: 'tab-block',
          dirName: 'TabBlock',
          version: 'latest',
          title: '标签页',
        },
      ],
    },
    {
      page: 'NotFound',
      route: 'exception/404',
      layout: 'HeaderAsideFooterLayout',
      blocks: [
        {
          name: '@lugia/basic-not-found-block',
          dirName: 'BasicNotFound',
          version: 'latest',
          title: '404 报错提示',
        },
      ],
    },
  ],
};
```

## 约定式路由

根据配置的目录名 `pages` 目录自动生成路由配置。

以大小写区分页面组件

### 基础路由

假设 `pages` 目录结构如下：

```
+ pages/
  + Users/
    + blocks
      - Header.js
      - Footer.js
    - index.js
    - List.js
  - index.js
```

那么会自动生成路由配置如下：

```js
[
  { path: '/', component: './pages/index.js' },
  { path: '/users/', component: './pages/Users/index.js' },
  { path: '/users/list', component: './pages/Users/List.js' },
];
```

### 动态路由

约定带 `$` 前缀的目录或文件为动态路由。

比如以下目录结构：

```
+ pages/
  + $Post/
    - index.js
    - Comments.js
  + Users/
    $Id.js
  - index.js
```

会生成路由配置如下：

```js
[
  { path: '/', component: './pages/index.js' },
  { path: '/users/:id', component: './pages/Users/$Id.js' },
  { path: '/:post/', component: './pages/$Post/index.js' },
  { path: '/:post/comments', component: './pages/$Post/Comments.js' },
];
```

### 可选的动态路由

约定动态路由如果带 `$` 后缀，则为可选动态路由。

比如以下结构：

```
+ pages/
  + Users/
    - $Id$.js
  - index.js
```

会生成路由配置如下：

```js
[
  { path: '/': component: './pages/index.js' },
  { path: '/users/:id?': component: './pages/Users/$Id$.js' },
]
```
